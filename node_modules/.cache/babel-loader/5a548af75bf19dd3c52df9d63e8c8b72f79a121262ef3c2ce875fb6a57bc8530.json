{"ast":null,"code":"import mercadopago from \"mercadopago\";\nimport { MERCADOPAGO_API_KEY } from \"../config.js\";\nexport const createOrder = async (req, res) => {\n  mercadopago.configure({\n    access_token: MERCADOPAGO_API_KEY\n  });\n  try {\n    const {\n      items\n    } = req.body;\n    if (!items || !Array.isArray(items) || items.length === 0) {\n      return res.status(400).json({\n        message: \"No hay productos en el carrito.\"\n      });\n    }\n    const result = await mercadopago.preferences.create({\n      items: items.map(item => ({\n        title: item.title,\n        unit_price: item.unit_price,\n        quantity: item.quantity,\n        currency_id: \"COP\"\n      })),\n      back_urls: {\n        success: \"http://localhost:3000/success\",\n        failure: \"http://localhost:3000/failure\",\n        pending: \"http://localhost:3000/pending\"\n      },\n      auto_return: \"approved\",\n      notification_url: \"https://<tu-ngrok-o-servidor-publico>/webhook\"\n    });\n    res.json(result.body);\n  } catch (error) {\n    console.error(\"Error al crear la orden:\", error);\n    return res.status(500).json({\n      message: \"Error interno al crear la orden.\"\n    });\n  }\n};","map":{"version":3,"names":["mercadopago","MERCADOPAGO_API_KEY","createOrder","req","res","configure","access_token","items","body","Array","isArray","length","status","json","message","result","preferences","create","map","item","title","unit_price","quantity","currency_id","back_urls","success","failure","pending","auto_return","notification_url","error","console"],"sources":["C:/Users/usuario/Desktop/LengWeb/TiendaVirtual/src/controllers/payment.controller.js"],"sourcesContent":["import mercadopago from \"mercadopago\";\r\nimport { MERCADOPAGO_API_KEY } from \"../config.js\";\r\n\r\nexport const createOrder = async (req, res) => {\r\n  mercadopago.configure({\r\n    access_token: MERCADOPAGO_API_KEY,\r\n  });\r\n\r\n  try {\r\n    const { items } = req.body;\r\n\r\n    if (!items || !Array.isArray(items) || items.length === 0) {\r\n      return res.status(400).json({ message: \"No hay productos en el carrito.\" });\r\n    }\r\n\r\n    const result = await mercadopago.preferences.create({\r\n      items: items.map(item => ({\r\n        title: item.title,\r\n        unit_price: item.unit_price,\r\n        quantity: item.quantity,\r\n        currency_id: \"COP\"\r\n      })),\r\n      back_urls: {\r\n        success: \"http://localhost:3000/success\",\r\n        failure: \"http://localhost:3000/failure\",\r\n        pending: \"http://localhost:3000/pending\"\r\n      },\r\n      auto_return: \"approved\",\r\n      notification_url: \"https://<tu-ngrok-o-servidor-publico>/webhook\"\r\n    });\r\n\r\n    res.json(result.body);\r\n  } catch (error) {\r\n    console.error(\"Error al crear la orden:\", error);\r\n    return res.status(500).json({ message: \"Error interno al crear la orden.\" });\r\n  }\r\n};\r\n"],"mappings":"AAAA,OAAOA,WAAW,MAAM,aAAa;AACrC,SAASC,mBAAmB,QAAQ,cAAc;AAElD,OAAO,MAAMC,WAAW,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,KAAK;EAC7CJ,WAAW,CAACK,SAAS,CAAC;IACpBC,YAAY,EAAEL;EAChB,CAAC,CAAC;EAEF,IAAI;IACF,MAAM;MAAEM;IAAM,CAAC,GAAGJ,GAAG,CAACK,IAAI;IAE1B,IAAI,CAACD,KAAK,IAAI,CAACE,KAAK,CAACC,OAAO,CAACH,KAAK,CAAC,IAAIA,KAAK,CAACI,MAAM,KAAK,CAAC,EAAE;MACzD,OAAOP,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAAkC,CAAC,CAAC;IAC7E;IAEA,MAAMC,MAAM,GAAG,MAAMf,WAAW,CAACgB,WAAW,CAACC,MAAM,CAAC;MAClDV,KAAK,EAAEA,KAAK,CAACW,GAAG,CAACC,IAAI,KAAK;QACxBC,KAAK,EAAED,IAAI,CAACC,KAAK;QACjBC,UAAU,EAAEF,IAAI,CAACE,UAAU;QAC3BC,QAAQ,EAAEH,IAAI,CAACG,QAAQ;QACvBC,WAAW,EAAE;MACf,CAAC,CAAC,CAAC;MACHC,SAAS,EAAE;QACTC,OAAO,EAAE,+BAA+B;QACxCC,OAAO,EAAE,+BAA+B;QACxCC,OAAO,EAAE;MACX,CAAC;MACDC,WAAW,EAAE,UAAU;MACvBC,gBAAgB,EAAE;IACpB,CAAC,CAAC;IAEFzB,GAAG,CAACS,IAAI,CAACE,MAAM,CAACP,IAAI,CAAC;EACvB,CAAC,CAAC,OAAOsB,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;IAChD,OAAO1B,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAAmC,CAAC,CAAC;EAC9E;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}